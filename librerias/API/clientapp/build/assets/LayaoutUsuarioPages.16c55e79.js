import{c as F,j as e,g as Q,i as ee,h as te,d as u,Y as S,B as D,r as h,A as G,b as P,a as A,f as re,Z as ae,$ as M,X as V,T as _,a0 as X,G as E,a1 as k,a2 as q,a3 as oe,R as se,y as R,N as ie}from"./index.ad9b7e92.js";import{N as ne}from"./NavigationComponent.ea8de845.js";import{H as Y}from"./HeaderComponent.0bc9406d.js";import{A as f,I as N,a as j}from"./usuarioDTO.2394de0e.js";import{T as le,a as ce,b as de,c as w,d as g,e as ue}from"./TableRow.15b8d78b.js";import{S as he}from"./Switch.e46fbfe5.js";import{E as me}from"./EditOutlined.5e41b408.js";import{d as pe}from"./Search.67c90013.js";import{S as ge}from"./SkeletonDynamic.d264f9d2.js";import{V as B}from"./ValidationForms.a47614c1.js";import{D as fe,a as xe,b as be,c as Ce}from"./DialogTitle.c4648013.js";import{D as ye}from"./DialogContentText.514f3ba6.js";import{S as Ee}from"./SinInformacion.9e7bb934.js";import{I as ve}from"./InputAdornment.67d4ad97.js";import{A as ke}from"./Add.73b42c3e.js";import{P as De}from"./PersonOutline.4e83a010.js";import"./SwitchBase.70273b65.js";const ze=F(e("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"}),"LockOutlined"),Ae=F(e("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"}),"MailOutline"),Te=F(e("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");var H={},Se=ee.exports;Object.defineProperty(H,"__esModule",{value:!0});var Z=H.default=void 0,Ie=Se(Q()),Le=te,Pe=(0,Ie.default)((0,Le.jsx)("path",{d:"M10 4h4v4h-4zM4 16h4v4H4zm0-6h4v4H4zm0-6h4v4H4zm10 8.42V10h-4v4h2.42zm6.88-1.13-1.17-1.17c-.16-.16-.42-.16-.58 0l-.88.88L20 12.75l.88-.88c.16-.16.16-.42 0-.58zM11 18.25V20h1.75l6.67-6.67-1.75-1.75zM16 4h4v4h-4z"}),"AppRegistration");Z=H.default=Pe;const Ue=()=>u(S,{children:[e(Y,{title:"Perfiles"}),e(D,{sx:{m:"1px",background:"white",height:"calc(100vh - 150px)"},children:"PerfilPages"})]}),Oe=(r,o)=>{switch(o.type){case"add all":return{usuarios:[...o.payload]};case"add":return{usuarios:[...r.usuarios,o.payload]};case"edit":return{usuarios:[...r.usuarios.map(n=>{const s=n;return s.id==o.payload.id?o.payload:s})]};case"remove":return{usuarios:[...r.usuarios.filter(n=>n.id!==o.payload)]};case"cambia estado":return{usuarios:[...r.usuarios.map(n=>{const s=n;return s.id==o.payload._id&&(s.estado=o.payload.estado),s})]}}},U=h.exports.createContext({newUser:r=>{},isloading:!1,state:[],dispatch:()=>{}}),Me=({children:r})=>{const[o,n]=h.exports.useReducer(Oe,{usuarios:[]}),[s,p]=h.exports.useState(!1),{showAlert:l}=h.exports.useContext(G),d=i=>{p(!0),P({metodo:"Usuario",type:A.POST,data:i}).then(a=>{var t,x;(a==null?void 0:a.item1.success)==!0?(n({type:i.id==0?"add":"edit",payload:a.item2}),l((t=a==null?void 0:a.item1)==null?void 0:t.mensaje,"Exitoso","success")):l((x=a==null?void 0:a.item1)==null?void 0:x.mensaje,"Mensaje","warning"),p(()=>!1)}).catch(()=>{})};return e(U.Provider,{value:{state:o.usuarios,dispatch:n,isloading:s,newUser:d},children:r})},Ve=({onClick:r})=>{const{state:o}=h.exports.useContext(U),n={inputProps:{"aria-label":"Switch demo"}},[s,p]=h.exports.useState(null),[l,d]=h.exports.useState();h.exports.useState([...o]);const i=Boolean(s);return{state:o,clickEstado:(m,c,I)=>{m.target.checked==!0?r({action:f.EstadoTrue,userData:c}):r({action:f.EstadoFalse,userData:c})},handleClick:(m,c)=>{p(m.currentTarget),d(c),r({action:f.Default,userData:c})},anchorEl:s,handleClose:()=>{p(null)},open:i,clickAction:m=>{r({action:m,userData:l})},label:n}},_e=({onClick:r})=>{const{anchorEl:o,clickAction:n,clickEstado:s,handleClick:p,handleClose:l,open:d,state:i,label:a}=Ve({onClick:r});return e(le,{sx:{maxHeight:440},children:u(ce,{stickyHeader:!0,"aria-label":"sticky table",size:"small",children:[e(de,{children:u(w,{children:[u(g,{align:"left",style:{fontWeight:"bold"},children:["Nombre"," "]},"thNombre"),e(g,{align:"left",style:{fontWeight:"bold"},children:"Documento"},"thDocumento"),e(g,{align:"left",style:{fontWeight:"bold"},children:"Cargo"},"thcargo"),e(g,{align:"left",style:{fontWeight:"bold"},children:"Correo"},"thcorreo"),e(g,{align:"left",style:{fontWeight:"bold"},children:"Celular"},"thCelular"),e(g,{align:"left",style:{fontWeight:"bold"},children:"Estado"},"thEstado"),e(g,{align:"center",style:{fontWeight:"bold"},children:"Acciones"},"thAcciones")]})}),e(ue,{children:i.map((t,x)=>u(w,{hover:!0,role:"checkbox",tabIndex:-1,children:[e(g,{children:t.nombre},`tdNom${t.id}`),e(g,{children:t.documento},`tdDoc${t.id}`),e(g,{children:t.cargo},`tdCar${t.id}`),e(g,{children:t.correo},`tdCor${t.id}`),e(g,{children:t.celular},`tdCel${t.id}`),e(g,{children:e(he,{...a,checked:t.estado==1,onChange:b=>s(b,t,x),size:"small"})},`tdSwi${t.id}`),u(g,{align:"center",children:[e(re,{size:"small",onClick:b=>p(b,t),children:e(Te,{sx:{color:"#1E62A1"}})}),u(ae,{anchorEl:o,id:`tdmenu${t.id}`,open:d,onClose:l,onClick:l,PaperProps:{elevation:0,sx:{width:"214px",overflow:"visible",filter:"drop-shadow(0px 2px 2px rgba(0,0,0,0.22))"}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[u(M,{onClick:()=>n(f.Edit),children:[e(V,{children:e(me,{color:"primary"})}),e(_,{children:"Editar usuario"})]}),u(M,{onClick:()=>n(f.Send),children:[e(V,{children:e(Ae,{color:"primary"})}),e(_,{children:"Enviar correo"})]}),u(M,{onClick:()=>n(f.Pass),children:[e(V,{children:e(ze,{color:"primary"})}),e(_,{children:"Cambiar contrasena"})]})]})]},`tdOpc${t.id}`)]},`tr${t.id}`))})]})})},Re=()=>{const{hasError:r,data:o,isLoading:n,doFetch:s,setState:p}=X(),{dispatch:l,state:d}=h.exports.useContext(U);return h.exports.useEffect(()=>{s({metodo:"Usuario?tipo=p",type:A.GET,AllowAnonymous:!1})},[]),h.exports.useEffect(()=>{o!=null&&o.length>0&&l({type:"add all",payload:o})},[o]),{state:d,isLoading:n}},je=({newUser:r,open:o,close:n,tipo:s,editUser:p})=>{const[l,d]=h.exports.useState(s==T.add?N:p),[i,a]=h.exports.useState(j),t=()=>{n(!1)},x=c=>{const{name:I,value:L}=c.target;d(O=>({...O,[I]:L}))},b=()=>{const c=m();a(c),!(c.cargo.hasError||c.celular.hasError||c.documento.hasError||c.email.hasError||c.nombre.hasError)&&(a(j),r(l),d(N),t())},m=()=>{let c=j;if(!new B().EmailIsValid(l.correo)){debugger;return{...c,email:{hasError:!0,msn:"Correo invalido"}}}return l.correo==""?{...c,email:{hasError:!0,msn:"Campo obligatorio"}}:l.nombre==""?{...c,nombre:{hasError:!0,msn:"Campo obligatorio"}}:l.cargo==""?{...c,cargo:{hasError:!0,msn:"Campo obligatorio"}}:l.documento==""?{...c,documento:{hasError:!0,msn:"Campo obligatorio"}}:new B().OnlyInteger(l.documento)?l.celular==""?{...c,celular:{hasError:!0,msn:"Campo obligatorio"}}:c:{...c,documento:{hasError:!0,msn:"Campo obligatorio"}}};return{handleClose:t,onChangeFrm:x,dataNewUser:l,dataValidate:i,submit:b}};var T=(r=>(r.add="add",r.edit="edit",r))(T||{});const qe=({newUser:r,open:o,close:n,tipo:s,editUser:p})=>{const{handleClose:l,onChangeFrm:d,dataNewUser:i,dataValidate:a,submit:t}=je({newUser:r,open:o,close:n,tipo:s,editUser:p});return e(S,{children:u(fe,{open:o,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"md",children:[e(xe,{id:"alert-dialog-title",children:s=="add"?"Nuevo usuario":"Editar usuario"}),e(be,{children:e(ye,{id:"alert-dialog-description",children:u(E,{container:!0,spacing:2,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:1,children:[e(E,{item:!0,xs:6,children:e(k,{required:!0,name:"nombre",label:"Nombre",fullWidth:!0,size:"small",onChange:d,value:i==null?void 0:i.nombre,error:a.nombre.hasError,helperText:a.nombre.msn})}),e(E,{item:!0,xs:6,children:e(k,{required:!0,name:"documento",label:"Numero de documento",fullWidth:!0,size:"small",onChange:d,error:a.documento.hasError,helperText:a.documento.msn,value:i==null?void 0:i.documento,type:"number"})}),e(E,{item:!0,xs:6,children:e(k,{required:!0,name:"cargo",label:"Cargo",fullWidth:!0,size:"small",onChange:d,error:a.cargo.hasError,helperText:a.cargo.msn,value:i==null?void 0:i.cargo})}),e(E,{item:!0,xs:6,children:e(k,{required:!0,error:a.email.hasError,name:"correo",label:"Email",fullWidth:!0,size:"small",onChange:d,helperText:a.email.msn,value:i==null?void 0:i.correo})}),e(E,{item:!0,xs:6,children:e(k,{required:!0,name:"celular",label:"Celular",fullWidth:!0,size:"small",onChange:d,error:a.celular.hasError,helperText:a.celular.msn,type:"number",value:i==null?void 0:i.celular})}),e(E,{item:!0,xs:6})]})})}),u(Ce,{children:[e(q,{variant:"outlined",onClick:l,children:"Cancelar"}),e(q,{variant:"contained",color:"primary",onClick:t,autoFocus:!0,children:"Guardar"})]})]})})},Fe=()=>{const{showAlert:r}=h.exports.useContext(G),{data:o,isLoading:n,setState:s}=X(),[p,l]=h.exports.useState(!1),{dispatch:d,newUser:i}=h.exports.useContext(U),[a,t]=h.exports.useState(!1),[x,b]=h.exports.useState(T.add),m=h.exports.useRef(),c=()=>{l(!1)},I=()=>{b(T.add),t(!0)},L=()=>{b(T.edit),t(!0)},O=v=>{switch(v){case f.Delete:l(!0);break;case f.Edit:L();break;case f.Send:J();break;case f.EstadoTrue:W(!0);break;case f.EstadoFalse:W(!1);break;case f.Pass:K();break;case f.New:}},J=async()=>{var y;s({isLoading:!0,hasError:""});let v={idUsuario:(y=m.current)==null?void 0:y.id};const z={metodo:"Usuario/envioCorreo",type:A.POST,data:v},C=await P(z);console.log(C),C!=null&&C.success&&r(C.mensaje,"Exitoso","success"),s({isLoading:!1,hasError:""})},W=async v=>{var $;s({isLoading:!0,hasError:""});let z={usuario:($=m==null?void 0:m.current)==null?void 0:$.id,activo:v};const C={metodo:"Usuario/cambiarestado",type:A.POST,data:z},y=await P(C);y!=null&&y.success&&(d({type:"cambia estado",payload:{_id:m==null?void 0:m.current.id,estado:v?1:0}}),r("Estado actualizado existosamente","Exitoso","success")),s({isLoading:!1,hasError:""})},K=async()=>{var y;s({isLoading:!0,hasError:""});let v={idUsuario:(y=m.current)==null?void 0:y.id};const z={metodo:"Usuario/resetPassword",type:A.POST,data:v},C=await P(z);console.log(C),s({isLoading:!1,hasError:""})};return{isLoading:n,data:o,openDelete:p,dataUserSelect:m,openD:a,tipoModal:x,handleCloseDelete:c,newUser:i,actionUser:O,handleClickDialogOpenAdd:I,handleClickDialogOpenEdit:L,setOpen:t}},He=()=>{const{state:r}=Re(),{isLoading:o,dataUserSelect:n,openD:s,tipoModal:p,actionUser:l,newUser:d,setOpen:i,handleClickDialogOpenAdd:a}=Fe();return u(S,{children:[o?e(D,{mt:6,children:e(ge,{NoColumnas:1,NoFilas:4,Tipo:"table"})}):u(S,{children:[u(D,{display:"flex",justifyContent:"end",pt:"10px",children:[e(k,{id:"outlined-basic",size:"small",placeholder:"Buscar...",sx:{width:"400px"},InputProps:{endAdornment:e(ve,{position:"end",children:e(pe,{})})},label:"Buscar...",variant:"outlined"}),u(q,{sx:{ml:"20px"},variant:"text",onClick:a,children:[" ",e(ke,{sx:{mr:"8px"}}),"Agregar usuario"]})]}),(r==null?void 0:r.length)!=0?e(D,{m:"10px",mt:"25px",children:r==null?e(oe,{color:"inherit"}):e(_e,{onClick:t=>{t.action!=f.Default&&(n.current=t.userData,l(t.action))}})}):e(D,{mt:2,justifyContent:"center",display:"flex",children:e(Ee,{})})]}),s?e(qe,{open:s,tipo:p,editUser:n.current,newUser:t=>{d(t)},close:t=>{i(t)}}):null]})},We=()=>u(S,{children:[e(Y,{title:"Usuarios"}),e(Me,{children:e(D,{sx:{m:"1px",background:"white",height:"calc(100vh - 150px)"},children:e(He,{})})})]}),$e=[{path:"/usuarios/usuario",texto:"Admin. de usuarios",Icono:()=>e(De,{})},{path:"/usuarios/perfil",texto:"Admin. de perfiles",Icono:()=>e(Z,{})}];function Ne(){return u(se,{children:[e(R,{path:"/usuario",element:e(We,{})}),e(R,{path:"/perfil",element:e(Ue,{})}),e(R,{path:"/*",element:e(ie,{to:"/usuarios/usuario"})})]})}const lt=()=>{const[r,o]=h.exports.useState({sm:7,lg:10,md:10,xs:7});return u(E,{container:!0,spacing:2,children:[e(ne,{options:$e,sizeLayout:n=>{o(n)}}),e(E,{item:!0,...r,sx:{paddingLeft:"0px !important"},children:e(Ne,{})})]})};export{lt as LayaoutUsuarioPages,lt as default};
